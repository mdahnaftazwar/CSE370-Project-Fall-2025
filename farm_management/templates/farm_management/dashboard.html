{% extends "farm_management/base.html" %}

{% block content %}
<h1>
    {% if request.session.user_type == 'Staff' %}
    My Assigned Cattle
    {% else %}
    Global Cattle Inventory
    {% endif %}
</h1>
<table>
    <thead>
        <tr>
            <th>Cattle ID</th>
            <th>Animal Name</th>
            <th>Gender</th>
            <th>Health Status</th>
            <th>Assigned Caretaker</th>
            <th>Breeding Status</th>
            <th>Breeding</th>
            <th>Production</th>
            <th>Sale Status</th>
        </tr>
    </thead>
    <tbody>
        {% for cattle in cattle_list %}
        <tr style="border-bottom:1px solid #ddd;">  
            <td>{{ cattle.0 }}</td>
            <td>{{ cattle.1 }}</td>
            <td>{{ cattle.2 }}</td>
            <td>{{ cattle.3 }}</td>
            <td>{{ cattle.4|default:"Unassigned" }}</td>

            <!-- Color-coded Breeding Status -->
            <td>
                {% if cattle.5 %}
                    {% if cattle.5 == "Pregnant" %}
                        <span style="background-color:#4CAF50; color:white; padding:4px 8px; border-radius:4px;">{{ cattle.5 }}</span>
                    {% elif cattle.5 == "In Heat" %}
                        <span style="background-color:#FFC107; color:white; padding:4px 8px; border-radius:4px;">{{ cattle.5 }}</span>
                    {% elif cattle.5 == "Breeding Failed" %}
                        <span style="background-color:#F44336; color:white; padding:4px 8px; border-radius:4px;">{{ cattle.5 }}</span>
                    {% elif cattle.5 == "Calved" %}
                        <span style="background-color:#2196F3; color:white; padding:4px 8px; border-radius:4px;">{{ cattle.5 }}</span>
                    {% else %}
                        <span style="background-color:#9E9E9E; color:white; padding:4px 8px; border-radius:4px;">{{ cattle.5 }}</span>
                    {% endif %}
                {% else %}
                    <span style="background-color:#9E9E9E; color:white; padding:4px 8px; border-radius:4px;">Not Breeding</span>
                {% endif %}
            </td>


            <!-- Add Record & View Log buttons -->
            <td>
                {% if request.session.user_type == 'Staff' or request.session.user_type == 'Vet' %}
                <a href="{% url 'add_breeding' cattle.0 %}"
                    style="background-color:#4CAF50; color:white; padding:5px 10px; text-decoration:none; border-radius:4px; margin-right:5px;">
                    Add Record
                </a>
                {% endif %}

                <a href="{% url 'breeding_log' cattle.0 %}"
                    style="background-color:#2196F3; color:white; padding:5px 10px; text-decoration:none; border-radius:4px;">
                    View Log
                </a>
            </td>

            <!-- Production Log button -->
            <td>
                <a href="{% url 'production_log' cattle.0 %}"
                    style="background-color:#2196F3; color:white; padding:5px 10px; text-decoration:none; border-radius:4px;">
                    View Production
                </a>
            </td>

            <!-- Sale Status -->
            <td>
                {% if cattle.6 == "For Sale" %}
                    <span style="color:#2e7d32; font-weight:bold;">ðŸŸ¢ For Sale</span>
                    {% if festival_tag %}
                        <div style="margin-top:4px; font-size:12px; color:#d84315;">{{ festival_tag }}</div>
                    {% endif %}
                {% elif cattle.6 == "Sold" %}
                    <span style="color:#f44336; font-weight:bold;">ðŸ›‘ Sold</span>
                {% else %}
                    <span style="color:#616161; font-weight:bold;">âšª Not for Sale</span>
                {% endif %}

                {% if request.session.user_type in "Staff Vet" %}
                    <br>
                    <a href="{% url 'update_sale_status' cattle.0 %}" style="font-size:12px; color:#2196F3; text-decoration:none;">Update Sale</a>
                {% endif %}
            </td>



        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}