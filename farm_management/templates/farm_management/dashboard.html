{% extends "farm_management/base.html" %}

{% block content %}
<h1>
    {% if request.session.user_type == 'Staff' and request.session.username != 'admin' %}
    My Assigned Cattle
    {% else %}
    Global Cattle Inventory
    {% endif %}
</h1>
<table>
    <thead>
        <tr>
            <th>Cattle ID</th>
            <th>Animal Name</th>
            <th>Gender</th>
            <th>Health Score</th> <th>Health Status</th> <th>Assigned Caretaker</th>
            <th>Breeding Status</th>
            <th>Breeding Actions</th>
            <th>Production</th>
            <th>Sale Status</th>
        </tr>
    </thead>
    <tbody>
        {% for cattle in cattle_list %}
        <tr style="border-bottom:1px solid #ddd;">  
            <td>{{ cattle.0 }}</td>
            <td>{{ cattle.1 }}</td>
            <td>{{ cattle.2 }}</td>
            
            <td style="font-weight: bold; text-align: center;">
                {{ cattle.8|default:"--" }} / 100
            </td>

            <td>
                {% if cattle.3 == "Excellent" %}
                    <span style="color:#2e7d32; font-weight:bold;">üåü {{ cattle.3 }}</span>
                {% elif cattle.3 == "Healthy" %}
                    <span style="color:#4CAF50; font-weight:bold;">‚úÖ {{ cattle.3 }}</span>
                {% elif cattle.3 == "Sick" %}
                    <span style="color:#FFC107; font-weight:bold;">‚ö†Ô∏è {{ cattle.3 }}</span>
                {% elif cattle.3 == "Severely Sick" %}
                    <span style="color:#f44336; font-weight:bold;">üö® {{ cattle.3 }}</span>
                {% else %}
                    {{ cattle.3 }}
                {% endif %}

                {% if request.session.user_type == 'Vet' %}
                    <br>
                    <a href="{% url 'update_health' cattle.0 %}" style="font-size: 11px; color: #e67e22; text-decoration:none;">[Edit Health]</a>
                {% endif %}
            </td>

            <td>{{ cattle.4|default:"Unassigned" }}</td>

            <td>
                {% if cattle.5 %}
                    {% if cattle.5 == "Pregnant" %}
                        <span style="background-color:#4CAF50; color:white; padding:4px 8px; border-radius:4px;">{{ cattle.5 }}</span>
                    {% elif cattle.5 == "In Heat" %}
                        <span style="background-color:#FFC107; color:white; padding:4px 8px; border-radius:4px;">{{ cattle.5 }}</span>
                    {% elif cattle.5 == "Breeding Failed" %}
                        <span style="background-color:#F44336; color:white; padding:4px 8px; border-radius:4px;">{{ cattle.5 }}</span>
                    {% elif cattle.5 == "Calved" %}
                        <span style="background-color:#2196F3; color:white; padding:4px 8px; border-radius:4px;">{{ cattle.5 }}</span>
                    {% else %}
                        <span style="background-color:#9E9E9E; color:white; padding:4px 8px; border-radius:4px;">{{ cattle.5 }}</span>
                    {% endif %}
                {% else %}
                    <span style="background-color:#9E9E9E; color:white; padding:4px 8px; border-radius:4px;">Not Breeding</span>
                {% endif %}
            </td>

            <td>
                {% if request.session.user_type == 'Staff' or request.session.user_type == 'Vet' %}
                <a href="{% url 'add_breeding' cattle.0 %}"
                    style="background-color:#4CAF50; color:white; padding:5px 10px; text-decoration:none; border-radius:4px; margin-right:5px; font-size:12px;">
                    Update
                </a>
                {% endif %}
                <a href="{% url 'breeding_log' cattle.0 %}"
                    style="background-color:#2196F3; color:white; padding:5px 10px; text-decoration:none; border-radius:4px; font-size:12px;">
                    Logs
                </a>
            </td>

            <td>
                <a href="{% url 'production_log' cattle.0 %}"
                    style="background-color:#2196F3; color:white; padding:5px 10px; text-decoration:none; border-radius:4px; font-size:12px;">
                    Production
                </a>
            </td>

            <td>
                {% if cattle.6 == "For Sale" %}
                    <span style="color:#2e7d32; font-weight:bold;">üü¢ For Sale</span>
                    {% if festival_tag %}
                        <div style="margin-top:4px; font-size:12px; color:#d84315;">{{ festival_tag }}</div>
                    {% endif %}
                {% elif cattle.6 == "Sold" %}
                    <span style="color:#f44336; font-weight:bold;">üõë Sold</span>
                {% else %}
                    <span style="color:#616161; font-weight:bold;">‚ö™ Not for Sale</span>
                {% endif %}

                {% if request.session.user_type == 'Staff' or request.session.user_type == 'Vet' %}
                    <br>
                    <a href="{% url 'update_sale_status' cattle.0 %}" style="font-size:12px; color:#2196F3; text-decoration:none;">Update Sale</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}